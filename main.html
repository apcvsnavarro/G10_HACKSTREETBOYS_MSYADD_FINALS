<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ODCC Dashboard Enhanced</title>
<link rel="stylesheet" href="style.css" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  .notifications { border: 1px solid #ccc; padding: 10px; margin-top: 10px; max-height: 150px; overflow-y: auto; }
  .widget-customize { margin-top: 20px; }
</style>
</head>
<body>
<div class="sidebar">
  <!-- existing sidebar nav here -->
</div>

<div class="main-content">
  <div class="header">Accounting Dashboard</div>
  <div class="profile-icon" title="User Profile"></div>

  <div class="cards-row">
    <div class="dashboard-card">
      <h3>Total Balance</h3>
      <div class="value">$48,350</div>
      <canvas id="balanceChart" width="400" height="150"></canvas>
    </div>

    <div class="dashboard-card">
      <h3>Receivables</h3>
      <div class="value">$12,420</div>
    </div>

    <!-- additional cards as before -->

  </div>

  <button id="exportCsvBtn">Export Dashboard Summary</button>

  <div class="notifications" id="notifications">
    <h4>Notifications</h4>
    <ul id="notificationList">
      <li>Payment of $1200 due in 3 days</li>
      <li>Tax filing deadline approaching</li>
    </ul>
  </div>

  <div class="widget-customize">
    <h4>Customize Widgets</h4>
    <label><input type="checkbox" checked id="toggleReceivables"> Show Receivables</label><br />
    <label><input type="checkbox" checked id="toggleExpenses"> Show Expenses</label>
  </div>
</div>

<script>
  // Chart.js interactive line chart for balance trends
  const ctx = document.getElementById('balanceChart').getContext('2d');
  const balanceChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
      datasets: [{
        label: 'Total Balance',
        data: [45000, 46000, 47000, 48000, 48500, 48300, 48350],
        borderColor: 'rgba(57,64,138,0.8)',
        backgroundColor: 'rgba(57,64,138,0.2)',
        fill: true,
        tension: 0.3
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { display: true }
      },
      scales: {
        y: { beginAtZero: false }
      }
    }
  });

  // CSV export functionality
  document.getElementById('exportCsvBtn').addEventListener('click', () => {
    const data = [
      ['Metric', 'Value'],
      ['Total Balance', '$48,350'],
      ['Receivables', '$12,420'],
      ['Expenses', '$6,340'],
      ['Payables', '$3,780']
    ];
    let csvContent = "data:text/csv;charset=utf-8," + data.map(e => e.join(",")).join("\n");
    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", "dashboard_summary.csv");
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  });

  // Widget customization example
  document.getElementById('toggleReceivables').addEventListener('change', function() {
    const receivablesCard = [...document.getElementsByClassName('dashboard-card')].find(card =>
      card.querySelector('h3').innerText === 'Receivables'
    );
    receivablesCard.style.display = this.checked ? 'block' : 'none';
  });

  document.getElementById('toggleExpenses').addEventListener('change', function() {
    const expensesCard = [...document.getElementsByClassName('dashboard-card')].find(card =>
      card.querySelector('h3').innerText === 'Expenses'
    );
    expensesCard.style.display = this.checked ? 'block' : 'none';
  });
</script>
</body>
</html>
